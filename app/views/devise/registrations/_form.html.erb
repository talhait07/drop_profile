<%= devise_error_messages %>
<%= flash_message %>
<% users = User.all.collect { |u| u.username }.flatten.to_a %>
<%= form_for resource, as: resource_name, url: registration_path(resource_name), class: 'form-horizontal' do |f| %>
    <div class="col-lg-12 n-signup-all n-signup-field  lato-font ">
      <div class="controls">
        <div class="input-prepend">
          <%= f.email_field :email, placeholder: 'Email Address', required: true %>
        </div>
      </div>
    </div>


    <div class="col-lg-6 col-sm-6 col-md-6 col-xs-12   n-signup-all n-signup-field lato-font ">
      <div class="control-group   ">
        <div class="controls   ">
          <div class="input-prepend">
            <%= f.text_field :first_name, placeholder: 'First name', class: 'fl-name', required: true %>
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-6 col-sm-6 col-md-6 col-xs-12   n-signup-all n-signup-field lato-font ">
      <div class="control-group ">
        <div class="controls  ">
          <div class="input-prepend">
            <%= f.text_field :last_name, placeholder: 'Last name', class: 'fl-name' %>
          </div>
        </div>
      </div>
    </div>
    <span class="clearfix"></span>

    <div class="col-lg-6 col-sm-6 col-md-6 col-xs-12  n-signup-all n-signup-field lato-font ">
      <div class="control-group   ">
        <div class="controls   ">
          <div class="input-prepend">
            <%= f.password_field :password, placeholder: 'Password', required: true, autocomplete: 'off' %>
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-6 col-sm-6 col-md-6 col-xs-12   n-signup-all n-signup-field lato-font ">
      <div class="control-group ">
        <div class="controls  ">
          <div class="input-prepend">
            <%= f.password_field :password_confirmation, placeholder: 'Confirm Password', required: true, autocomplete: 'off' %>
          </div>
        </div>
      </div>
    </div>
    <span class="clearfix"></span>


    <div class="col-lg-12  lato-font">
      <div class="date-form ">
        <div class="control-group">
          <div class="controls">
            <div class="input-group">
              <label class="input-group-addon btn for-site-url"><%= full_url(root_path) %></label>
              <%= f.text_field :username, placeholder: 'username', required: true, class: 'form-control txt-sze-un user-field-hgt n-username', autocomplete: 'off' %>

            </div>
          </div>
        </div>
      </div>
      <span class="clearfix"></span>

      <div class="col-lg-12 text-right">
        <div id="username-uniqueness" data-users="<%= users %>">

        </div>
      </div>
    </div>
    <span class="clearfix"></span>

    <span class="uel-s"></span>

    <div class="form-actions n-signup-field lato-font">
      <%= f.submit 'Sign Up' %>
    </div>
<% end %>
<span class="clearfix"></span>

<script>
    $(document).ready(function () {
        var usernames = $('#username-uniqueness').data('users');

        $(".n-username").keyup(function () {
            if (usernames.indexOf($('.n-username').val()) > -1) {
                document.getElementById('username-uniqueness').innerHTML = '<i class="fa fa-warning" style="margin-bottom: 15px;"></i> Username taken!'
            }
            else {
                document.getElementById('username-uniqueness').innerHTML = '<i class="fa fa-check" style="margin-bottom: 15px;"></i> Username available!'
            }
            if ($('.n-username').val().length <= 0) {
                document.getElementById('username-uniqueness').innerHTML = ''
            }
        });

    })
</script>